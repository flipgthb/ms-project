%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Thin Sectioned Essay
% LaTeX Template
% Version 1.0 (3/8/13)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original Author:
% Nicolas Diaz (nsdiaz@uc.cl) with extensive modifications by:
% Vel (vel@latextemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%------------------------------------------------------------------------------

\documentclass[a4paper, 11pt]{article} % Font size (can be 10pt, 11pt or 12pt) 
                                       % and paper size (remove a4paper for US 
                                       % letter paper)

\usepackage[protrusion=true,expansion=true]{microtype} % Better typography
\usepackage{graphicx} % Required for including pictures
\usepackage{wrapfig} % Allows in-line images
\usepackage[utf8]{inputenc} % Allows all utf-8 caracters
\usepackage{amsmath}

\usepackage{mathpazo} % Use the Palatino font
\usepackage[T1]{fontenc} % Required for accented characters
\linespread{1.05} % Change line spacing here, Palatino benefits from a slight 
                  % increase by default of the publication
\makeatletter
\renewcommand\@biblabel[1]{\textbf{#1.}} % Change the square brackets for each
                                         % bibliography item from '[1]' to '1.'
\renewcommand{\@listI}{\itemsep=0pt} % Reduce the space between items in the 
                                     % itemize and enumerate environments and 
                                     % the bibliography

\renewcommand{\maketitle}{ % Customize the title - do not edit title and author
                           % name here, see the TITLE block below
\begin{flushright} % Right align
{\LARGE\@title} % Increase the font size of the title

\vspace{50pt} % Some vertical space between the title and author name

{\large\@author} % Author name
\\\@date % Date

\vspace{40pt} % Some vertical space between the author block and abstract
\end{flushright}
}

%------------------------------------------------------------------------------
%   MACROS
%------------------------------------------------------------------------------

\newcommand{\msr}[1]{\ensuremath{\displaystyle%
    \mathrm{d}\mu\left(#1\right)}}

\newcommand{\agent}[2]{%
    \omega^{#2}_{#1}}

\newcommand{\conf}{%
    \underline \omega}

\newcommand{\subpot}{\ensuremath{\displaystyle%
    V_{rs}^{\mu \nu,\; \rho}}}

\newcommand{\pot}{\ensuremath{\displaystyle%
    V_{rs}^{\mu \nu}}}

\newcommand{\opn}[2]{\ensuremath{\displaystyle%
    h^{#2,\;\rho}_{#1}}}

\renewcommand{\H}{%
    \mathcal{H}}

\newcommand{\ln}{%
    \mathrm{ln}}

\newcommand{\mh}[1]{\ensuremath{\displaystyle%
    m^{\rho}_{#1}}}

\newcommand{\rh}[1]{\ensuremath{\displaystyle%
    r^{\rho}_{#1}}}

\newcommand{\Mh}[1]{\ensuremath{\displaystyle%
    M^{\rho}_{#1}}}

\newcommand{\Rh}[1]{\ensuremath{\displaystyle%
    R^{\rho}_{#1}}}

\newcommand{\inp}[1]{\ensuremath{\displaystyle%
    \left(#1\right)}}

\newcommand{\ina}[1]{\ensuremath{\displaystyle%
    \left<#1\right>}}

\newcommand{\ins}[1]{\ensuremath{\displaystyle%
    \left[#1\right]}}

\newcommand{\inc}[1]{\ensuremath{\displaystyle%
    \left{#1\right}}}

%------------------------------------------------------------------------------
%	TITLE
%------------------------------------------------------------------------------

\title{\textbf{Equações de Campo Médio}}%\\ % Title
% Focused and Deliciously Witty Subtitle} % Subtitle

% \author{\textsc{Ford Prefect} % Author
% \\{\textit{Interstellar University}}} % Institution

%  \date{\today} % Date

%------------------------------------------------------------------------------

\begin{document}

\maketitle % Print the title section

%------------------------------------------------------------------------------
%	ABSTRACT AND KEYWORDS
%------------------------------------------------------------------------------

% \renewcommand{\abstractname}{Summary} % Uncomment to change the name of the 
                                       % abstract to something else

% \begin{abstract}
% Morbi tempor congue porta. Proin semper, leo vitae faucibus dictum, metus mauris lacinia lorem, ac congue leo felis eu turpis. Sed nec nunc pellentesque, gravida eros at, porttitor ipsum. Praesent consequat urna a lacus lobortis ultrices eget ac metus. In tempus hendrerit rhoncus. Mauris dignissim turpis id sollicitudin lacinia. Praesent libero tellus, fringilla nec ullamcorper at, ultrices id nulla. Phasellus placerat a tellus a malesuada.
% \end{abstract}

% Keywords
% \hspace*{3,6mm}\textit{Keywords:} lorem , ipsum , dolor , sit amet , lectus 
\vspace{30pt} % Some vertical space between the abstract and first section

%------------------------------------------------------------------------------
%	ESSAY BODY
%------------------------------------------------------------------------------

\section*{O Modelo}

Queremos descrever a interação de dois grupos de agentes que trocam informação
sobre duas possíveis questões. Sejam $ \omega^{\mu}=\{\agent{r}{\mu}\} $ com 
$ \mu \in \{1,2\} $ e $r \in \{1,\ldots, N_{\mu}\}$ as configurações dos grupos
$1$ e $2$, com $\agent{r}{\mu} \in \mathbb{R}^D$ o vetor cognitivo do agente $r$
do grupo $\mu$ para algum $D$, e $N^{\mu}$ o número de agentes no grupo $\mu$.
Vamos denotar a configuração global por
$\conf = \omega^1 \cup \omega^2$. Para representar os
dois assuntos discutidos, considere os vetores $x^1,\;x^2 \in \mathbb{R}^D$ e
considere que todos os vetores estão normalizados, ou seja, 
$|\agent{r}{\mu}|=|x^{\rho}|=1$. A informação que um agente passa (recebe) sobre 
um dos assuntos é definida pelo produto escalar entre seu vetor cognitivo e o 
dado assunto. Sejam, portanto, os campos 
$\opn{r}{\mu}=\agent{r}{\mu} \cdot x^{\rho}$.  

A troca de informação é tal que os agentes tentam minimizar os "erros" que
cometem em relação com seus vizinhos. A dinâmica resultante pode ser vista como
uma descida pelo gradiente de uma função "Energia" do sistema. A evolução de um
agente quando recebe um exemplo é dada pela equação

\begin{equation}
    \agent{r}{\mu}(t+1)=\agent{r}{\mu}(t)+\eta F(\opn{r}{\mu},\sigma, x^{\rho})
    \sigma x^{\rho}
\end{equation}

onde $F$ é a função de modulação, $\sigma$ é a opinião do interlocutor sobre o
assunto $x^{\rho}$ no instante $t$. Podemos escrever a função de modulação como o
gradiente de um potencial $ F = -\nabla V $, com

\begin{equation}\label{subject-potential}
    \subpot = -\frac{1+\delta}{2}\opn{r}{\mu}\opn{s}{\nu}
                      +\frac{1-\delta}{2}|\opn{r}{\mu}\opn{s}{\nu}|
\end{equation}

Esse potentcial assegura que a função de modulação da um peso $\delta \in [0,1]$
para informação corroborativa e peso $1$ para novidade, ou seja, os agentes
aprendem mais quando discordam do que quando concordam e, dado que eles aprendem
no sentido de corrigir os erros, espera-se que num cenário em que existe apenas
um assunto e um grupo, o consenso seja atingido como função do parâmetro
$\delta$. Esse potencial é interpretado como o custo da discordância entre os
agentes $r$ e $s$ dos grupos $\mu$ e $\nu$ sobre o assunto $\rho$. Podemos
simplificar um pouco definido o custo da discordância sobre todos os assuntos
entre dois agentes fazendo 

\begin{equation}\label{pair-potential}
    \pot = \sum_{\rho=1,2} \subpot
\end{equation}

Com isso, podemos escrever o custo total da discordância na sociedade como sendo
a soma dos custos entre cada agente. Mas queremos estudar a diferença entre os
grupos então vamos criar parâmetros que distinguem as interações intra-grupo e
inter-grupos. Sejam $J>0$ e $K>0$ as escalas de energia da interação entre
indivíduos de grupos distintos e entre indivíduos de mesmo grupo,
respectivamente. A energia total do sistema é dada pelo hamiltoniano

\begin{equation}
    \H = -\frac{J}{2N}\sum_{\mu \ne \nu}\sum_{rs}\pot
                 +\frac{K}{2N}\sum_{\mu=\nu}\sum_{r\ne s}\pot
\end{equation}

onde $N = N^1 + N^2$ é o número total de agentes. Note que esse hamiltoniano
penaliza a discordância entre agentes de um mesmo grupo a concordância entre
agentes de grupos diferentes. Desse modo, esperamos que no equilíbrio, haja dois
grupos bem formados do ponto de vista das opiniões.

É razoável supor que o valor
esperado do hamiltoniano seja uma informação relavante, de modo que, por máxima
entropia, a probabilidade de observar uma certa configuração $\conf$
é dada pela distribuição de Boltzmann 

\[P(\conf) = \frac{1}{Z}e^{-\beta \H}\]

com $ Z = \sum_{\conf} e^{-\beta \H} $ a função de
partição.

%------------------------------------------------

\section*{Campo Médio}

Para prosseguir, vamos tentar uma aproximação de campo médio para o sistema.
Isso é feito a partir da aproximação da distribuição de probabilidades $P$ dada
acima por uma família de distribuições que se fatora entre agentes
independentes. Isto é, queremos aproximar $P \approx P_{MF} =
\prod_{\mu,\;r}P^{\mu}_r $. A melhor aproximação possível para essa família
de distribuições é aquela que minimiza a divergência de Kullback-Liebler entre
$P$ e $P_{MF}$, definida por 

\begin{equation}
    S[P_{MF}||P] = -\int
    \msr{\conf}P_{MF}\mathrm{ln}\inp{\frac{P_{MF}}{P}}
    -\sum_{\mu,r}\lambda_r^{\mu}\ina{P^{\mu}_r-1}_{\agent{r}{\mu}} 
    - \beta\ina{P_{MF}\H - E}_{\conf}
\end{equation}

onde as constantes $\lambda$ e $\beta$ repesentam os vínculos de normalização e
valor esperado do hamiltoniano. Vamos tomar variações de $S[P_{MF}||P]$ em
relação a $P^{\mu}_r$. Vamos ver como a $S$ se fatora em termos dessas
distribuições

\begin{equation}
    \begin{split}
        S[P_{MF}||P] & = -\int
        \msr{\conf}P_{MF}\ln\inp{\frac{P_{MF}}{P}}
        -\sum_{\mu,r}\lambda_r^{\mu}\ina{P^{\mu}_r-1}_{\agent{r}{\mu}} 
        - \beta\ina{P_{MF}\mathcal{H} - E}_{\conf} \\
    % step 1
    & =  -\int
        \prod_{\mu,\;r}\msr{\agent{r}{\mu}}P^{\mu}_r
        \ln \inp{\frac{\prod_{\mu,\;r}P^{\mu}_r}{P}}\\
        &\quad -\sum_{\mu,r}\lambda_r^{\mu}\ins{\int \msr{\agent{r}{\mu}}
        P^{\mu}_r-1} \\
        &\quad -
        \beta\ins{\int\prod_{rs}\msr{\agent{r}{\mu}}\msr{\agent{s}{\nu}}
        P^{\mu}_rP^{\nu}_s\H-E}\\
    % step 2
    & =  -
        \sum_{\mu,\;r}\int\msr{\agent{r}{\mu}}P^{\mu}_r
        \ln \inp{\frac{P^{\mu}_r}{P}}\\
        &\quad -\sum_{\mu,r}\lambda_r^{\mu}\ins{\int \msr{\agent{r}{\mu}}
        P^{\mu}_r-1} \\
        &\quad -
        \beta\ins{\sum_{\mu\nu}\sum_{rs}\int\msr{\agent{r}{\mu}}
            \msr{\agent{s}{\nu}}P^{\mu}_rP^{\nu}_sA^{\mu\nu}_{rs}\pot-E}\\
    \end{split}
\end{equation}

onde $A_{rs}^{\mu\nu} = \frac{K}{N}\delta_{\mu\nu}(1-\delta_{rs}) - 
\frac{J}{N}(1-\delta_{\mu\nu})$
discrimina agentes num mesmo grupo de agentes em grupos diferentes. Agora,
tomando variações $\frac{\delta S}{\delta{P^{\mu}_r}} = 0$ termos

\begin{equation}\label{mean-field-p}
    \begin{split}
        0 & = \frac{\delta S}{\delta P^{\mu}_r} \\
          & = 1 - \ln P^{\mu}_r - \lambda_r^{\mu} 
        - \beta\sum_{s,\nu}A_{rs}^{\mu\nu}\int \msr{\agent{s}{\nu}}
        P^{\nu}_s \pot \\
        \implies & P_r^{\mu} \propto exp \inp{%
        - \beta\sum_{s,\nu}A_{rs}^{\mu\nu}\int \msr{\agent{s}{\nu}}
    P^{\nu}_s \pot }
    \end{split}
\end{equation}

Com isso, basta integrar $\pot$ para determinar as distribuição de
campo médio do sistema. Vejamos como podemos lidar com isso. Chamando
$D\agent{s}{\nu}=\msr{\agent{s}{\nu}}$, temos

\begin{equation}
    \begin{split}
        \int D\agent{s}{\nu} \pot & = \\
        & = \int D\agent{s}{\nu} \sum_{\rho}
        \ins{-\frac{1+\delta}{2}\opn{r}{\mu}\opn{s}{\nu}
        +\frac{1-\delta}{2}|\opn{r}{\mu}\opn{s}{\nu}|} \\ 
        & = \sum_{\rho}\int D\agent{s}{\nu}
        \ins{-\frac{1+\delta}{2} \opn{r}{\mu}\opn{s}{\nu}
        +\frac{1-\delta}{2}|\opn{r}{\mu}\opn{s}{\nu}|} \\ 
        & = \sum_{\rho}
        \ins{-\frac{1+\delta}{2}\opn{r}{\mu} \mh{\nu}
            +\frac{1-\delta}{2}|\opn{r}{\mu}| \rh{\nu}} \\ 
    \end{split}
\end{equation}

onde definimos os parâmetros de ordem

\begin{equation}\label{order-parameter-m}
    \mh{\nu} = \int \msr{\agent{s}{\nu}}P^{\nu}_r \agent{s}{\nu} \cdot x^{\rho}
\end{equation}


\begin{equation}\label{order-parameter-r}
    \rh{\nu} = \int\msr{\agent{s}{\nu}}P^{\nu}_r |\omega_s^{\nu} \cdot x^{\rho}|
\end{equation}

Note que, visto que estamos trabalhando com dois assuntos e dois grupos, temos
$8$ parâmetros de ordem no total. Note também que a dependência dos parâmetros
de ordem sobre o subíndice, que representa o índice dos agentes, foi removido
sobre a hipótese de homogeneidade da distribuição de campo médio. Ou seja, os
agentes não são necessariamente idênticos, mas são identicamente distribuídos.

Agora a integral de $\pot$ pode ser reescrita em termos dos parâmetros de ordem:

\begin{equation}
    \begin{split}
        \sum_{\mu\nu}\sum_{rs}A^{\mu\nu}_{rs}\int D\agent{s}{\nu} \pot & = \\
        & = 
        \sum_{\mu\nu}\sum_{rs}A^{\mu\nu}_{rs}\sum_{\rho}\ins{%
        -a\opn{r}{\mu}\mh{\nu}+b|\opn{r}{\mu}|\rh{\nu}}\\
        & =
        \sum_{\rho}\ins{%
        -a\inp{\frac{K(N^{\mu}-1)}{2N}}\opn{r}{\mu}\mh{\mu}
        +b\inp{\frac{K(N^{\mu}-1)}{2N}}|\opn{r}{\mu}|\rh{\mu}\\
        &  
        -a\inp{-\frac{JN^{\nu}}{2N}}\opn{r}{\mu}\mh{\nu}
   \left+b\inp{-\frac{JN^{\nu}}{2N}}|\opn{r}{\mu}|\rh{\nu}} \\
        & =
        -a\inp{\frac{K(N^{\mu}-1)}{2N}-\frac{JN^{\nu}}{2N}}\opn{r}{\mu}\mh{\mu}\\
        &
        \quad+b\inp{\frac{K(N^{\mu}-1)}{2N}-\frac{JN^{\nu}}{2N}}|
        \opn{r}{\mu}|\rh{\mu}\\
    \end{split}
\end{equation}

com $a=\frac{1+\delta}{2}$ e $b=\frac{1-\delta}{2}$. No limite termodinâmico, 
$N \to \infty$ com $\frac{N_{\mu}}{N} = \textit{cte}$,
os podemos fazer $n^{\mu} = \frac{N_{\mu}}{N}$ e reescrever a equação acima

\begin{equation}
    \begin{split}
        \sum_{\mu\nu}\sum_{rs}A^{\mu\nu}_{rs}\int D\agent{s}{\nu} \pot & = \\
        & 
        -a\inp{\frac{Kn^{\mu}}{2}-\frac{Jn^{\nu}}{2}}\opn{r}{\mu}\mh{\mu}\\
        &
        +b\inp{\frac{Kn^{\mu}}{2}-\frac{Jn^{\nu}}{2}}|
        \opn{r}{\mu}|\rh{\mu}\\
    \end{split}
\end{equation}

e, chamando $\Mh{\mu} =
\frac{Kn^{\mu}}{2}m^{\mu\rho}-\frac{Jn^{\nu}}{2}m^{\nu\rho} $ e $\Rh{\mu}
= \frac{Kn^{\mu}}{2}r^{\mu\rho}-\frac{Jn^{\nu}}{2}r^{\nu\rho}$, podemos escrever
o resultado final da seguinte forma

\begin{equation}\label{mean-field-P}
    P_r^{\mu} = \frac{1}{Z_r^{\mu}} \mathrm{exp} \ins{%
        \beta\sum_{\rho}\inp{a\Mh{\mu}\opn{r}{\mu}-b\Rh{\mu}|\opn{r}{\mu}|}}
\end{equation}

Com esse resultado, podemos entender as equações~\ref{order-parameter-m} 
e~\ref{order-parameter-r} como equações de auto-consistência da aproximação de
campo médio e suas soluções indicam os possíveis valores dos parâmetros de
ordem. 

%------------------------------------------------

\section*{Equações de Auto-Consistência}

Os resultados da seção anterior são válidos para qualquer dimensão $D$ dos
vetores cognitivos dos agentes. Para avançã um pouco mais, vamos nos restringir
ao caso $D=5$, de acordo com a Teoria dos Fundamentos Morais. Para simplificar a
notação, note que a distribuição de campo médio obtida depende do grupo do
agente, mas não de cada agente no grupo. Então, vamos omitir o índice refente ao
agente (até então $r$ ou $s$) e vamos baixar o índice de grupo, $\mu$ ou $\nu$.
Com isso, a equação~\ref{mean-field-P} escreve-se 

\newcommand{\hf}[2]{%
    h_{#1}^{#2}}

\begin{equation} 
    P_{\mu} = \frac{1}{Z_{\mu}} \mathrm{exp} \ins{%
    \beta \sum_{\rho} \inp{a\Mh{\mu}\hf{\mu}{\rho} - b\Rh{\mu}|\hf{\mu}{\rho}|}}
\end{equation}

Para escrever as integrais~\ref{order-parameter-m} e~\ref{order-parameter-r}
vamos usar coordenadas esféricas em $D=5$. Se $q_{i}$, $i \in {1,\ldots,5}$, 
são coordenadas cartesianas, a parametrização esférica é dada por 

\newcommand{\cos}{\mathrm{cos}}
\newcommand{\sen}{\mathrm{sen}}

\begin{equation*}
    \begin{align}
        q_1 = r \cos \theta _1 \\
        q_2 = r \sen \theta _1 \cos \theta _2 \\
        q_3 = r \sen \theta _1 \sen \theta _2 \cos \theta _3 \\
        q_4 = r \sen \theta _1 \sen \theta _2 \sen \theta _3 \cos \theta _4 \\
        q_5 = r \sen \theta _1 \sen \theta _2 \sen \theta _3 \sen \theta _4
    \end{align}
\end{equation*}

e o jacobiano da transformação é 

\begin{equation*}
    d^D v = r^4 \sen ^3 \theta _1 \sen ^2 \theta _2 \sen \theta _3 
    drd\theta_1d\theta_2d\theta_3d\theta_4
\end{equation*}

Como todos os vetores cognitivos dos agentes e os vetores dos assuntos estão
normalizados, as integrais são feitas sobre a superfície da esfera unitária, ou
seja $r=1$. Considere que $x^1 \cdot x^2 = \cos \gamma$, escolha $q_1 =
x^1$ e $ x^2 = q_1\cos \gamma  + q_2\sen \gamma $, e chame $\theta_1 = \theta$ e
$\theta_2 = \phi$. Com isso, as integrais sobre $\theta_3$ e $\theta_4$ são
apenas constantes e podem ser absorvidas na função de partição, e as únicas
integrais a serem feitas são sobre $\theta$ e $\phi$, ambas no intervalo
$[0,\pi]$. 

Podemos reescrever a opinião de um agente em relação aos assuntos $1$ ou $2$ de
acordo com angulos $\theta,\phi$ e $\gamma$:

\[
    g\inp{\theta,\phi,\gamma} = \hf{\mu}{\rho} = 
    \begin{cases} 
        \cos \theta & \textit{ , caso $\rho=1$ } \\
        \sen \gamma \sen \theta \cos \phi + \cos \theta \cos \gamma &
        \textit{, caso $\rho=2$}
    \end{cases}
\]

e a medida sobre o vetor cognitivo de um agente escreve-se 

\[
    \msr{\agent{r}{\mu}} = \sen ^3 \theta \sen ^2 \phi d\theta d\phi
\]

Note que a função $g\inp{\theta,\phi,\gamma}$ produz $h^1_{\mu}$ para $\gamma=0$
e $h^2_{\mu}$ para $\gamma \ne 0$, e chamando $g_{\rho}=\begin{cases}
    g(\theta,\phi,0) &
,\rho=1 \\ g(\theta,\phi,\gamma) & ,\rho=2 \end{cases}$, podemos escrever as
equações~\ref{order-parameter-m} e~\ref{order-parameter-r} da seguinte forma

\begin{equation} \label{self-consistent-m}
    \mh{\mu} = \frac{1}{Z_{\mu}}
    \int_0^{\pi} d\theta \; d\phi \; \sen^3 \theta \; \sen^2 \phi \; 
    g_{\rho} \mathrm{exp} 
    \ins{\beta \sum_{\rho} \inp{a\Mh{\mu}g_{\rho} \\
    & -b\Rh{\mu}|g_{\rho}|}}
\end{equation}


\begin{equation} \label{self-consistent-r}
    \rh{\mu} = \frac{1}{Z_{\mu}}
    \int_0^{\pi} d\theta \; d\phi \; \sen^3 \theta \; \sen^2 \phi \; 
    |g_{\rho}| \mathrm{exp} 
    \ins{\beta \sum_{\rho} \inp{a\Mh{\mu}g_{\rho} \\
    & -b\Rh{\mu}|g_{\rho}|}}
\end{equation}

com a função de partição dada por


\begin{equation} \label{self-consistent-Z}
    Z_{\mu} = 
    \int_0^{\pi} d\theta \; d\phi \; \sen^3 \theta \; \sen^2 \phi \; 
    \mathrm{exp} 
    \ins{\beta \sum_{\rho} \inp{a\Mh{\mu}g_{\rho} \\
    & -b\Rh{\mu}|g_{\rho}|}}
\end{equation}

%------------------------------------------------

% \section*{Conclusion}

% \begin{enumerate}
% \item First numbered list item
% \item Second numbered list item
% \end{enumerate}

% \begin{wrapfigure}{l}{0.4\textwidth} % Inline image example
% \begin{center}
% \includegraphics[width=0.38\textwidth]{fish.png}
% \end{center}
% \caption{Fish}
% \end{wrapfigure}

%------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%------------------------------------------------------------------------------

% \bibliographystyle{unsrt}

% \bibliography{sample}

%------------------------------------------------------------------------------

\end{document}
